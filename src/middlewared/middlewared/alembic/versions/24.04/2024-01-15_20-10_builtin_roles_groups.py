"""Built-in roles groups

Revision ID: 809e46a452e0
Revises: a33672445bed
Create Date: 2024-01-15 20:10:22.012464+00:00

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy import text


# revision identifiers, used by Alembic.
revision = '809e46a452e0'
down_revision = 'a33672445bed'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    conn = op.get_bind()

    conn.execute(text("INSERT INTO account_bsdgroups (bsdgrp_gid, bsdgrp_group, bsdgrp_builtin, bsdgrp_smb,"
                 "bsdgrp_sudo_commands, bsdgrp_sudo_commands_nopasswd) VALUES (951, 'truenas_readonly_administrators', "
                 "1, 1, '[]', '[]')"))

    conn.execute(text("INSERT INTO account_bsdgroups (bsdgrp_gid, bsdgrp_group, bsdgrp_builtin, bsdgrp_smb,"
                 "bsdgrp_sudo_commands, bsdgrp_sudo_commands_nopasswd) VALUES (952, 'truenas_sharing_administrators', "
                 "1, 1, '[]', '[]')"))

    op.execute(text(
        "UPDATE account_privilege SET builtin_name = 'READONLY_ADMINISTRATOR', name = 'Read-Only Administrator', "
        "local_groups = '[951]', roles = '[\"READONLY_ADMIN\"]' "
        "WHERE builtin_name = 'READONLY'"
    ))
    op.execute(text(
        "UPDATE account_privilege SET builtin_name = 'SHARING_ADMINISTRATOR', name = 'Sharing Administrator', "
        "local_groups = '[952]', roles = '[\"SHARING_ADMIN\"]' "
        "WHERE builtin_name = 'SHARING_MANAGER'"
    ))
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###
